


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>æŒä¹…é‚®ç®± &mdash; Akka æ–‡æ¡£</title>
    <link rel="stylesheet" href="../_static/style.css" tppabs="http://www.gtan.com/akka_doc/_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" tppabs="http://www.gtan.com/akka_doc/_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/prettify.css" tppabs="http://www.gtan.com/akka_doc/_static/prettify.css" type="text/css" />
    <link rel="stylesheet" href="../_static/base.css" tppabs="http://www.gtan.com/akka_doc/_static/base.css" type="text/css" />
    <link rel="stylesheet" href="../_static/docs.css" tppabs="http://www.gtan.com/akka_doc/_static/docs.css" type="text/css" />
    <link rel="stylesheet" href="../../../fonts.googleapis.com/css-family=Exo-300,400,600,700.css" tppabs="http://fonts.googleapis.com/css?family=Exo:300,400,600,700" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js" tppabs="http://www.gtan.com/akka_doc/_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js" tppabs="http://www.gtan.com/akka_doc/_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js" tppabs="http://www.gtan.com/akka_doc/_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/toc.js" tppabs="http://www.gtan.com/akka_doc/_static/toc.js"></script>
    <script type="text/javascript" src="../_static/prettify.js" tppabs="http://www.gtan.com/akka_doc/_static/prettify.js"></script>
    <script type="text/javascript" src="../_static/highlightCode.js" tppabs="http://www.gtan.com/akka_doc/_static/highlightCode.js"></script>
    <script type="text/javascript" src="../_static/effects.core.js" tppabs="http://www.gtan.com/akka_doc/_static/effects.core.js"></script>
    <script type="text/javascript" src="../_static/effects.highlight.js" tppabs="http://www.gtan.com/akka_doc/_static/effects.highlight.js"></script>
    <script type="text/javascript" src="../_static/scrollTo.js" tppabs="http://www.gtan.com/akka_doc/_static/scrollTo.js"></script>
    <script type="text/javascript" src="../_static/contentsFix.js" tppabs="http://www.gtan.com/akka_doc/_static/contentsFix.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Akka Documentation" href="../index.html" />
    <link rel="up" title="Modules" href="index.html" />
    <link rel="next" title="HTTP" href="http.html" />
    <link rel="prev" title="Modules" href="index.html" /> 
  </head>
  <body>
  <div class="navbar">
    <div class="navbar-inner">
      <div class="container">
        <div class="navbar-logo">
          <a href="javascript:if(confirm('http://akka.io/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://akka.io/'" tppabs="http://akka.io/"><img src="../_static/logo-small.png" tppabs="http://www.gtan.com/akka_doc/_static/logo-small.png" /></a>
        </div>    
        <ul class="nav">
          <li><a href="javascript:if(confirm('http://www.gtan.com/welfare04.html  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.gtan.com/welfare04.html'" tppabs="http://www.gtan.com/welfare04.html">è¿”å›å¹¿è°ˆå…¬ç›Š</a></li>
        </ul>
      </div>
    </div>
  </div>
  <div class="main">
    <div class="container">
      <div class="page-title">æŒä¹…é‚®ç®±</div><div class="pdf-link"><a href="javascript:if(confirm('http://www.gtan.com/akka_doc/Akka.pdf  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ·şÎñÆ÷±¨¸æ¸ÃÎÄ¼şÎ´ÕÒµ½¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.gtan.com/akka_doc/Akka.pdf'" tppabs="http://www.gtan.com/akka_doc/Akka.pdf"><img src="../_static/pdf-icon.png" tppabs="http://www.gtan.com/akka_doc/_static/pdf-icon.png" style="height: 40px;" /></a></div></div>
    <div class="main-container">
      <div class="container">
        <div class="row">
          <div class="span12">
            <ul class="breadcrumb">           
              <li>
                 <span class="divider">|</span> <a href="http.html" tppabs="http://www.gtan.com/akka_doc/modules/http.html">HTTP</a> <span class="divider">Â»</span>
              </li>
              <li>
                <a href="../index.html" tppabs="http://www.gtan.com/akka_doc/index.html">ç›®å½•</a>
              </li>
              <li>
                <span class="divider">Â«</span> <a href="index.html" tppabs="http://www.gtan.com/akka_doc/modules/index.html">Modules</a> <span class="divider">|</span>
              </li>
              <li>
                ç‰ˆæœ¬ 2.0
              </li>
            </ul>         
          </div>
        </div>
        <div class="row">
          <div class="span9">
            
  <div class="section" id="durable-mailboxes">
<span id="id1"></span><h1>æŒä¹…é‚®ç®±</h1>
<div class="section" id="overview">
<h2>æ¦‚è¿°</h2>
<p>Akkaæ”¯æŒä¸€ç»„æŒä¹…é‚®ç®±. æŒä¹…é‚®ç®±æ˜¯æ ‡å‡†actoré‚®ç®±çš„æ›¿ä»£å“ï¼Œä¸åŒä¹‹å¤„åœ¨äºå®ƒæ˜¯æŒä¹…åŒ–çš„. å®ƒåœ¨å®é™…ä¸­çš„æ„ä¹‰åœ¨äº
    å¦‚æœactorçš„é‚®ç®±é‡Œæœ‰ä¸€ä¸ªæœªå¤„ç†æ¶ˆæ¯ï¼Œè¿™æ—¶actoræ‰€åœ¨çš„ç»“ç‚¹å´©æºƒï¼Œå½“ä½ é‡å¯è¿™ä¸ªç»“ç‚¹æ—¶ï¼Œactorå¯ä»¥è±¡æ²¡æœ‰ä»»ä½•äº‹æƒ…å‘ç”Ÿä¸€æ ·
    ç»§ç»­æ‰§è¡Œï¼›æ‰€æœ‰çš„æœªå¤„ç†æ¶ˆæ¯ä»ç„¶åœ¨é‚®ç®±é‡Œã€‚</p>
<p>æ‰€æœ‰è¿™äº›æŒä¹…é‚®ç®±éƒ½æ²¡æœ‰å¯¹å½“å‰æ¶ˆæ¯å®ç°äº‹åŠ¡ã€‚æœ‰å¯èƒ½actoråœ¨æ”¶åˆ°æ¶ˆæ¯ä¹‹åä½†è¿˜æœªå¤„ç†å®Œå°±å´©æºƒäº†ï¼Œè¿™æ—¶è¿™æ¡æ¶ˆæ¯å¯èƒ½ä¼šè¢«ä¸¢å¤±ã€‚</p>
<div class="admonition warning">
<p class="first admonition-title">è­¦å‘Š</p>
<p><strong>é‡è¦</strong></p>
<p class="last">è¿™äº›é‚®ç®±éƒ½æ”¯æŒé˜»å¡çš„æ¶ˆæ¯å‘é€ï¼Œi.e. å³ä¾èµ–äºfutureçš„æ¶ˆæ¯å‘é€æ“ä½œ;
    <tt class="docutils literal"><span class="pre">?</span></tt> æˆ– <tt class="docutils literal"><span class="pre">ask</span></tt>.
    å¦‚æœç»“ç‚¹å´©æºƒåé‡å¯äº†ï¼Œé˜»å¡ç€ç­‰å¾…åº”ç­”çš„çº¿ç¨‹ä¹Ÿå°±ä¸å­˜åœ¨äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•ä¼ é€’è¿™ä¸ªæ¶ˆæ¯.</p>
</div>
<p>ç›®å‰æ”¯æŒçš„æŒä¹…é‚®ç®±åŒ…æ‹¬:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">FileBasedMailbox</span></tt> &#8211; åº•å±‚åŸºäºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸Šçš„äº‹åŠ¡æ€§æ—¥å¿—</li>
<li><tt class="docutils literal"><span class="pre">RedisBasedMailbox</span></tt> &#8211; backed by Redis</li>
<li><tt class="docutils literal"><span class="pre">ZooKeeperBasedMailbox</span></tt> &#8211; backed by ZooKeeper</li>
<li><tt class="docutils literal"><span class="pre">BeanstalkBasedMailbox</span></tt> &#8211; backed by Beanstalkd</li>
<li><tt class="docutils literal"><span class="pre">MongoBasedMailbox</span></tt> &#8211; backed by MongoDB</li>
</ul>
</div></blockquote>
<p>è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å°†é€ä¸ªä»‹ç»è¿™äº›é‚®ç®±ã€‚</p>
<p>å®ç°ä½ è‡ªå·±çš„é‚®ç®±ä¹Ÿå¾ˆå®¹æ˜“ã€‚å‚è€ƒç°æœ‰çš„å®ç°</p>
<p>æˆ‘ä»¬è¿˜åœ¨è®¨è®ºåŠ å…¥ä»¥ä¸‹è¿™äº›æŒä¹…é‚®ç®±:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">AmqpBasedMailbox</span></tt> &#8211; AMQP based mailbox (default RabbitMQ)</li>
<li><tt class="docutils literal"><span class="pre">JmsBasedMailbox</span></tt> &#8211; JMS based mailbox (default ActiveMQ)</li>
<li><tt class="docutils literal"><span class="pre">CassandraBasedMailbox</span></tt> &#8211; Cassandra based mailbox</li>
<li><tt class="docutils literal"><span class="pre">CamelBasedMailbox</span></tt> &#8211; Camel based mailbox</li>
<li><tt class="docutils literal"><span class="pre">SqlBasedMailbox</span></tt> &#8211; SQL based mailbox for general RDBMS (Postgres, MySQL, Oracle etc.)</li>
</ul>
</div></blockquote>
<p>å¦‚æœä½ å¯¹è¿™äº›é‚®ç®±çš„éœ€æ±‚æœ‰æƒ³æ³•è¯·å‘Šè¯‰æˆ‘ä»¬ã€‚</p>
<div class="section" id="general-usage">
<span id="durablemailbox-general"></span><h3>ä¸€èˆ¬ç”¨æ³•</h3>
<p>æŒä¹…é‚®ç®±å’Œä»–ä»¬çš„é…ç½®é€‰é¡¹ä½äº
<tt class="docutils literal"><span class="pre">akka.actor.mailbox</span></tt> åŒ…ä¸­.</p>
<p>ä½ é€šè¿‡æ´¾å‘å™¨æ¥é…ç½®æŒä¹…é‚®ç®±ã€‚actoræ˜¯ä¸çŸ¥é“å®ƒæ‰€ä½¿ç”¨çš„é‚®ç®±ç±»å‹çš„ã€‚</p>
<p>åœ¨æ´¾å‘å™¨çš„é…ç½®ä¸­ä½ æŒ‡å®šé‚®ç®±çš„å…¨ç§°ç±»å:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">my</span><span class="o">-</span><span class="n">dispatcher</span> <span class="o">{</span>
  <span class="n">mailbox</span><span class="o">-</span><span class="k">type</span> <span class="o">=</span> <span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="nc">FileBasedMailboxType</span>
<span class="o">}</span>
</pre></div>
</div>
<p>è¿™æ˜¯ä¸€ä¸ªå¦‚ä½•ç”¨æŒä¹…æ´¾å‘å™¨åˆ›å»ºactorçš„ä¾‹å­ï¼Œç”¨scala:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">import</span> <span class="nn">akka.actor.Props</span>

    <span class="k">val</span> <span class="n">myActor</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">MyActor</span><span class="o">].</span><span class="n">withDispatcher</span><span class="o">(</span><span class="s">&quot;my-dispatcher&quot;</span><span class="o">),</span> <span class="n">name</span> <span class="k">=</span> <span class="s">&quot;myactor&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Java:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">import</span> <span class="nn">akka.actor.UntypedActorFactory</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">akka.actor.UntypedActor</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">akka.actor.Props</span><span class="o">;</span>

    <span class="nc">ActorRef</span> <span class="n">myActor</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span>
        <span class="k">new</span> <span class="nc">Props</span><span class="o">().</span><span class="n">withDispatcher</span><span class="o">(</span><span class="s">&quot;my-dispatcher&quot;</span><span class="o">).</span><span class="n">withCreator</span><span class="o">(</span><span class="k">new</span> <span class="nc">UntypedActorFactory</span><span class="o">()</span> <span class="o">{</span>
          <span class="n">public</span> <span class="nc">UntypedActor</span> <span class="n">create</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nc">MyUntypedActor</span><span class="o">();</span>
          <span class="o">}</span>
        <span class="o">}),</span> <span class="s">&quot;myactor&quot;</span><span class="o">);</span>
</pre></div>
</div>
<p>actoræ˜¯ä¸çŸ¥é“å®ƒæ‰€ä½¿ç”¨çš„é‚®ç®±ç±»å‹çš„ã€‚</p>
<p>è¿™ä¸ºä½ æä¾›äº†åœ¨åº”ç”¨ä¸­åˆ›å»ºåˆ†ç±»çš„å¥½æ–¹æ³•ï¼Œä½¿ç”¨åŒä¸€æ´¾å‘å™¨çš„ä¸€ç»„actoråŒæ—¶ä¹Ÿå…±äº«åŒæ ·çš„åç«¯å­˜å‚¨ã€‚æ›´å¤šä¿¡æ¯è§ <a class="reference internal" href="../scala/dispatchers.html#dispatchers-scala" tppabs="http://www.gtan.com/akka_doc/scala/dispatchers.html#dispatchers-scala"><em>æ¶ˆæ¯æ´¾å‘å™¨ (Scala)</em></a> æ–‡æ¡£.</p>
</div>
</div>
<div class="section" id="file-based-durable-mailbox">
<h2>åŸºäºæ–‡ä»¶çš„æŒä¹…é‚®ç®±</h2>
<p>è¿™ä¸ªé‚®ç®±çš„åº•å±‚æ˜¯æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸Šçš„äº‹åŠ¡æ€§æ—¥å¿—ã€‚è¿™æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œå› ä¸ºä¸éœ€è¦é¢å¤–çš„ç®¡ç†æ¶æ„ï¼Œä½†ä¸€èˆ¬è¿™å°±è¶³å¤Ÿäº†ï¼Œå®Œå…¨ç¬¦åˆä½ çš„éœ€æ±‚ã€‚</p>
<p>é€šè¿‡æ´¾å‘å™¨æ¥é…ç½®æŒä¹…é‚®ç®±ï¼Œè§
<a class="reference internal" href="#durablemailbox-general"><em>ä¸€èˆ¬ç”¨æ³•</em></a> ä½¿ç”¨ä»¥ä¸‹é‚®ç®±ç±»å‹.</p>
<p>é…ç½®:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">my</span><span class="o">-</span><span class="n">dispatcher</span> <span class="o">{</span>
  <span class="n">mailbox</span><span class="o">-</span><span class="k">type</span> <span class="o">=</span> <span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="nc">FileBasedMailboxType</span>
<span class="o">}</span>
</pre></div>
</div>
<p>ä½ ä¹Ÿå¯ä»¥å¯¹åŸºäºæ–‡ä»¶çš„æŒä¹…é‚®ç®±è¿›è¡Œé…ç½®å’Œè°ƒæ•´ã€‚åœ¨ <a class="reference internal" href="../general/configuration.html#configuration" tppabs="http://www.gtan.com/akka_doc/general/configuration.html#configuration"><em>é…ç½®æ–‡ä»¶</em></a> çš„ <tt class="docutils literal"><span class="pre">akka.actor.mailbox.file-based</span></tt> éƒ¨åˆ†ã€‚</p>
<div class="highlight-none"><div class="highlight"><pre>#############################################
# Akka æ–‡ä»¶é‚®ç®±å‚æ•°é…ç½®æ–‡ä»¶ #
#############################################

# è¿™æ˜¯åŒ…å«æ‰€æœ‰ç¼ºçœè®¾ç½®çš„å‚æ•°é…ç½®æ–‡ä»¶.
# åœ¨ä½ çš„ application.conf è¿›è¡Œç¼–è¾‘å’Œé‡å†™.
#
# æ›´å¤šä¿¡æ¯è§ &lt;https://github.com/robey/kestrel/&gt;

akka {
  actor {
    mailbox {
      file-based {
        # è¿™ä¸ªé˜Ÿåˆ—æ‰€åœ¨çš„ç›®å½•
        directory-path = &quot;./_mb&quot;
        
        # åœ¨é˜Ÿåˆ—åˆ°è¾¾è¿™ä¸ªé•¿åº¦ï¼ˆæ¶ˆæ¯æ•°ï¼‰åç»§ç»­æ·»åŠ æ¶ˆæ¯å°†ä¼šå¤±è´¥.
        max-items = 2147483647
        
        # åœ¨é˜Ÿåˆ—åˆ°è¾¾è¿™ä¸ªé•¿åº¦ï¼ˆå­—èŠ‚æ•°ï¼‰åç»§ç»­æ·»åŠ æ¶ˆæ¯å°†ä¼šå¤±è´¥.
        max-size = 2147483647 bytes
        
        # è¯•å›¾æ·»åŠ æ¯”è¿™ä¸ªé•¿åº¦å¤§ï¼ˆå­—èŠ‚æ•°ï¼‰çš„æ¶ˆæ¯å°†ä¼šå¤±è´¥.
        max-item-size = 2147483647 bytes
        
        # è¿™ä¸ªé˜Ÿåˆ—çš„æœ€å¤§è¶…æ—¶æ—¶é—´ (ç§’).
        max-age = 0s
        
        # æ—¥å¿—æ»šåŠ¨çš„æœ€å¤§é•¿åº¦.
        max-journal-size = 16 MiB
        
        # è¦è¿›å…¥read-behindæ¨¡å¼æ—¶çš„é•¿åº¦.
        max-memory-size = 128 MiB
        
        # æ—¥å¿—æ–‡ä»¶çš„æœ€å¤§æº¢å‡ºï¼ˆå€æ•°ï¼‰ï¼Œè¶…è¿‡è¿™ä¸ªå€¼å°†é‡æ–°åˆ›å»ºæ—¥å¿—æ–‡ä»¶.
        max-journal-overflow = 10
        
        # æ—¥å¿—æ–‡ä»¶çš„æœ€å¤§é•¿åº¦ï¼Œä¸ç®¡ä»€ä¹ˆæ¡ä»¶ï¼Œè¶…è¿‡è¿™ä¸ªå€¼å°†é‡æ–°åˆ›å»ºæ–‡ä»¶.
        max-journal-size-absolute = 9223372036854775807 bytes
        
        # å½“é˜Ÿåˆ—æ»¡æ—¶æ˜¯å¦ä¸¢å¼ƒæ—§çš„æ¶ˆæ¯ï¼ˆè€Œä¸æ˜¯æ–°çš„ï¼‰
        discard-old-when-full = on  
        
        # æ˜¯å¦è¦ä¿å­˜æ—¥å¿—æ–‡ä»¶
        keep-journal = on  
        
        # æ¯ä¸ªäº‹åŠ¡ä¹‹åæ˜¯å¦åŒæ­¥æ—¥å¿—
        sync-journal = off  
      }
    }
  }
}
</pre></div>
    è¯‘è€…æ³¨ï¼šAkka 2.0.2ä¸­ä»¥ä¸‹å‡ ç§æŒä¹…é‚®ç®±éƒ½è¢«Deprecatedäº†ï¼Œæ•…æ­¤å¤„æœªè¯‘ã€‚
</div>
</div>
<div class="section" id="redis-based-durable-mailbox">
<h2>Redis-based durable mailbox</h2>
<p>This mailbox is backed by a Redis queue. <a class="reference external" href="javascript:if(confirm('http://redis.io/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://redis.io/'" tppabs="http://redis.io/">Redis</a> Is a very
fast NOSQL database that has a wide range of data structure abstractions, one of
them is a queue which is what we are using in this implementation. This means
that you have to start up a Redis server that can host these durable
mailboxes. Read more in the Redis documentation on how to do that.</p>
<p>You configure durable mailboxes through the dispatcher, as described in
<a class="reference internal" href="#durablemailbox-general"><em>General Usage</em></a> with the following mailbox type.</p>
<p>Config:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">my</span><span class="o">-</span><span class="n">dispatcher</span> <span class="o">{</span>
  <span class="n">mailbox</span><span class="o">-</span><span class="k">type</span> <span class="o">=</span> <span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="nc">RedisBasedMailboxType</span>
<span class="o">}</span>
</pre></div>
</div>
<p>You also need to configure the IP and port for the Redis server. This is done in
the <tt class="docutils literal"><span class="pre">akka.actor.mailbox.redis</span></tt> section in the <a class="reference internal" href="../general/configuration.html#configuration" tppabs="http://www.gtan.com/akka_doc/general/configuration.html#configuration"><em>Configuration</em></a>.</p>
<div class="highlight-none"><div class="highlight"><pre>##############################################
# Akka Redis Mailboxes Reference Config File #
##############################################

# This is the reference config file that contains all the default settings.
# Make your edits/overrides in your application.conf.
#
# for more information see &lt;http://redis.io/&gt;

akka {
  actor {
    mailbox {
      redis {
        # hostname of where the redis queue resides
        hostname = &quot;127.0.0.1&quot;
        
        # port at which the redis queue resides
        port = 6379
      }
    }
  }
}
</pre></div>
</div>
</div>
<div class="section" id="zookeeper-based-durable-mailbox">
<h2>ZooKeeper-based durable mailbox</h2>
<p>This mailbox is backed by <a class="reference external" href="javascript:if(confirm('http://zookeeper.apache.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://zookeeper.apache.org/'" tppabs="http://zookeeper.apache.org/">ZooKeeper</a>. ZooKeeper
is a centralized service for maintaining configuration information, naming,
providing distributed synchronization, and providing group services This means
that you have to start up a ZooKeeper server (for production a ZooKeeper server
ensemble) that can host these durable mailboxes. Read more in the ZooKeeper
documentation on how to do that.</p>
<p>You configure durable mailboxes through the dispatcher, as described in
<a class="reference internal" href="#durablemailbox-general"><em>General Usage</em></a> with the following mailbox type.</p>
<p>Config:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">my</span><span class="o">-</span><span class="n">dispatcher</span> <span class="o">{</span>
  <span class="n">mailbox</span><span class="o">-</span><span class="k">type</span> <span class="o">=</span> <span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="nc">ZooKeeperBasedMailboxType</span>
<span class="o">}</span>
</pre></div>
</div>
<p>You also need to configure ZooKeeper server addresses, timeouts, etc. This is
done in the <tt class="docutils literal"><span class="pre">akka.actor.mailbox.zookeeper</span></tt> section in the <a class="reference internal" href="../general/configuration.html#configuration" tppabs="http://www.gtan.com/akka_doc/general/configuration.html#configuration"><em>Configuration</em></a>.</p>
<div class="highlight-none"><div class="highlight"><pre>##################################################
# Akka ZooKepper Mailboxes Reference Config File #
##################################################

# This is the reference config file that contains all the default settings.
# Make your edits/overrides in your application.conf.
#
# For more information see &lt;http://wiki.apache.org/hadoop/ZooKeeper&gt;

akka {
  actor {
    mailbox {
      zookeeper {
        # host and port to connect to ZooKeeper
        server-addresses = &quot;127.0.0.1:2181&quot;
        
        # timeout after which an unreachable client is considered dead and its session is closed
        session-timeout = 60s
        
        # maximum wait period while connecting to ZooKeeper service
        connection-timeout = 60s
      }
    }
  }
}
</pre></div>
</div>
</div>
<div class="section" id="beanstalk-based-durable-mailbox">
<h2>Beanstalk-based durable mailbox</h2>
<p>This mailbox is backed by <a class="reference external" href="javascript:if(confirm('http://kr.github.com/beanstalkd/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://kr.github.com/beanstalkd/'" tppabs="http://kr.github.com/beanstalkd/">Beanstalkd</a>.
Beanstalk is a simple, fast work queue. This means that you have to start up a
Beanstalk server that can host these durable mailboxes. Read more in the
Beanstalk documentation on how to do that.</p>
<p>You configure durable mailboxes through the dispatcher, as described in
<a class="reference internal" href="#durablemailbox-general"><em>General Usage</em></a> with the following mailbox type.</p>
<p>Config:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">my</span><span class="o">-</span><span class="n">dispatcher</span> <span class="o">{</span>
  <span class="n">mailbox</span><span class="o">-</span><span class="k">type</span> <span class="o">=</span> <span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="nc">BeanstalkBasedMailboxType</span>
<span class="o">}</span>
</pre></div>
</div>
<p>You also need to configure the IP, and port, and so on, for the Beanstalk
server. This is done in the <tt class="docutils literal"><span class="pre">akka.actor.mailbox.beanstalk</span></tt> section in the
<a class="reference internal" href="../general/configuration.html#configuration" tppabs="http://www.gtan.com/akka_doc/general/configuration.html#configuration"><em>Configuration</em></a>.</p>
<div class="highlight-none"><div class="highlight"><pre>##################################################
# Akka Beanstalk Mailboxes Reference Config File #
##################################################

# This is the reference config file that contains all the default settings.
# Make your edits/overrides in your application.conf.
#
# for more information see &lt;https://github.com/kr/beanstalkd/blob/v1.3/doc/protocol.txt&gt;

akka {
  actor {
    mailbox {
      beanstalk {
        # hostname to connect to
        hostname = &quot;127.0.0.1&quot;
        
        # port to connect to
        port = 11300
        
        # wait period in case of a connection failure before reconnect
        reconnect-window = 5s
        
        # integer number of seconds to wait before putting the job in
        # the ready queue. The job will be in the &quot;delayed&quot; state during this time.
        message-submit-delay = 0s
        
        # time to run -- is an integer number of seconds to allow a worker
        # to run this job. This time is counted from the moment a worker reserves
        # this job. If the worker does not delete, release, or bury the job within
        # &lt;ttr&gt; seconds, the job will time out and the server will release the job.
        message-time-to-live = 120s
      }
    }
  }

}
</pre></div>
</div>
</div>
<div class="section" id="mongodb-based-durable-mailboxes">
<h2>MongoDB-based Durable Mailboxes</h2>
<p>This mailbox is backed by <a class="reference external" href="javascript:if(confirm('http://mongodb.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://mongodb.org/'" tppabs="http://mongodb.org/">MongoDB</a>.
MongoDB is a fast, lightweight and scalable document-oriented database.  It contains a number of
features cohesive to a fast, reliable &amp; durable queueing mechanism which the Akka Mailbox takes advantage of.</p>
<p>Akka&#8217;s implementations of MongoDB mailboxes are built on top of the purely asynchronous MongoDB driver
(often known as <a class="reference external" href="javascript:if(confirm('http://github.com/bwmcadams/hammersmith  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://github.com/bwmcadams/hammersmith'" tppabs="http://github.com/bwmcadams/hammersmith">Hammersmith</a> and <tt class="docutils literal"><span class="pre">com.mongodb.async</span></tt>)
and as such are purely callback based with a Netty network layer.  This makes them extremely fast &amp;
lightweight versus building on other MongoDB implementations such as
<a class="reference external" href="javascript:if(confirm('http://github.com/mongodb/mongo-java-driver  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://github.com/mongodb/mongo-java-driver'" tppabs="http://github.com/mongodb/mongo-java-driver">mongo-java-driver</a> and <a class="reference external" href="javascript:if(confirm('http://github.com/mongodb/casbah  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://github.com/mongodb/casbah'" tppabs="http://github.com/mongodb/casbah">Casbah</a>.</p>
<p>You configure durable mailboxes through the dispatcher, as described in
<a class="reference internal" href="#durablemailbox-general"><em>General Usage</em></a> with the following mailbox type.</p>
<p>Config:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">my</span><span class="o">-</span><span class="n">dispatcher</span> <span class="o">{</span>
  <span class="n">mailbox</span><span class="o">-</span><span class="k">type</span> <span class="o">=</span> <span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="nc">MongoBasedMailboxType</span>
<span class="o">}</span>
</pre></div>
</div>
<p>You will need to configure the URI for the MongoDB server, using the URI Format specified in the
<a class="reference external" href="javascript:if(confirm('http://www.mongodb.org/display/DOCS/Connections  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.mongodb.org/display/DOCS/Connections'" tppabs="http://www.mongodb.org/display/DOCS/Connections">MongoDB Documentation</a>. This is done in
the <tt class="docutils literal"><span class="pre">akka.actor.mailbox.mongodb</span></tt> section in the <a class="reference internal" href="../general/configuration.html#configuration" tppabs="http://www.gtan.com/akka_doc/general/configuration.html#configuration"><em>Configuration</em></a>.</p>
<div class="highlight-none"><div class="highlight"><pre>################################################
# Akka MongoDB Mailboxes Reference Config File #
################################################

# This is the reference config file that contains all the default settings.
# Make your edits/overrides in your application.conf.

akka {
  actor {
    mailbox {
      mongodb {

        # Any specified collection name will be used as a prefix for
        # collections that use durable mongo mailboxes.
        # Follow Mongo URI Spec - http://www.mongodb.org/display/DOCS/Connections
        uri = &quot;mongodb://localhost/akka.mailbox&quot;

        # Configurable timeouts for certain ops
        timeout {
          # time to wait for a read to succeed before timing out the future
          read = 3000ms
          # time to wait for a write to succeed before timing out the future
          write = 3000ms
        }
      }
    }
  }
}
</pre></div>
</div>
<p>You must specify a hostname (and optionally port) and at <em>least</em> a Database name.  If you specify a
collection name, it will be used as a &#8216;prefix&#8217; for the collections Akka creates to store mailbox messages.
Otherwise, collections will be prefixed with <tt class="docutils literal"><span class="pre">mailbox.</span></tt></p>
<p>It is also possible to configure the timeout thresholds for Read and Write operations in the <tt class="docutils literal"><span class="pre">timeout</span></tt> block.</p>
</div>
</div>


          </div>
          <div class="span3"><p class="contents-title">Contents</p>
              <div id="scroller-anchor">
                <div id="scroller">
                  <div id="toc"></div>
                </div>
              </div></div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
  <div class="container">
    <ul>
      <li><h5>Akka</h5></li>
      <li><a href="javascript:if(confirm('http://akka.io/docs  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://akka.io/docs'" tppabs="http://akka.io/docs">Documentation</a></li>
      <li><a href="javascript:if(confirm('http://akka.io/downloads  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://akka.io/downloads'" tppabs="http://akka.io/downloads">Downloads</a></li>
      <li><a href="javascript:if(confirm('http://akka.io/news  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://akka.io/news'" tppabs="http://akka.io/news">News</a></li>
      <li><a href="javascript:if(confirm('http://letitcrash.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://letitcrash.com/'" tppabs="http://letitcrash.com/">Blog</a></li>
    </ul>
    <ul>
      <li><h5>Contribute</h5></li>
      <li><a href="javascript:if(confirm('http://github.com/akka/akka  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://github.com/akka/akka'" tppabs="http://github.com/akka/akka">Source Code</a></li>
      <li><a href="javascript:if(confirm('http://groups.google.com/group/akka-user  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://groups.google.com/group/akka-user'" tppabs="http://groups.google.com/group/akka-user">Mailing List</a></li>      
      <li><a href="javascript:if(confirm('http://www.assembla.com/spaces/akka/tickets  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.assembla.com/spaces/akka/tickets'" tppabs="http://www.assembla.com/spaces/akka/tickets">Report a Bug</a></li>      
    </ul>
    <ul>
      <li><h5>Company</h5></li>
      <li><a href="javascript:if(confirm('http://typesafe.com/products/typesafe-subscription  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://typesafe.com/products/typesafe-subscription'" tppabs="http://typesafe.com/products/typesafe-subscription">Commercial Support</a></li>
      <li><a href="javascript:if(confirm('http://akka.io/team  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://akka.io/team'" tppabs="http://akka.io/team">Team</a></li>
      <li><a href="mailto:info@typesafe.com">Contact</a></li>
    </ul>
    <ul>
      <li><img src="../_static/watermark.png" tppabs="http://www.gtan.com/akka_doc/_static/watermark.png" align="center"/></li>
    </ul>
  </div>
  <div class="container copyright">
    <p style="float: left;">
      Â© 2012 <a href="javascript:if(confirm('http://typesafe.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://typesafe.com/'" tppabs="http://typesafe.com/">Typesafe Inc.</a> <span class="license">Akka is Open Source and available under the Apache 2 License.</span>
    </p>
    <p style="float: right; font-size: 12px;">
      Last updated: Mar 08, 2012
    </p>          
  </div>
</div>
<script type="text/javascript">
  $('#toc').toc();
</script>
  

  </body>
</html>
<!-- Localized -->