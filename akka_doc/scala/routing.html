


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>è·¯ç”± (Scala) &mdash; Akka æ–‡æ¡£</title>
    <link rel="stylesheet" href="../_static/style.css" tppabs="http://www.gtan.com/akka_doc/_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" tppabs="http://www.gtan.com/akka_doc/_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/prettify.css" tppabs="http://www.gtan.com/akka_doc/_static/prettify.css" type="text/css" />
    <link rel="stylesheet" href="../_static/base.css" tppabs="http://www.gtan.com/akka_doc/_static/base.css" type="text/css" />
    <link rel="stylesheet" href="../_static/docs.css" tppabs="http://www.gtan.com/akka_doc/_static/docs.css" type="text/css" />
    <link rel="stylesheet" href="../../../fonts.googleapis.com/css-family=Exo-300,400,600,700.css" tppabs="http://fonts.googleapis.com/css?family=Exo:300,400,600,700" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js" tppabs="http://www.gtan.com/akka_doc/_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js" tppabs="http://www.gtan.com/akka_doc/_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js" tppabs="http://www.gtan.com/akka_doc/_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/toc.js" tppabs="http://www.gtan.com/akka_doc/_static/toc.js"></script>
    <script type="text/javascript" src="../_static/prettify.js" tppabs="http://www.gtan.com/akka_doc/_static/prettify.js"></script>
    <script type="text/javascript" src="../_static/highlightCode.js" tppabs="http://www.gtan.com/akka_doc/_static/highlightCode.js"></script>
    <script type="text/javascript" src="../_static/effects.core.js" tppabs="http://www.gtan.com/akka_doc/_static/effects.core.js"></script>
    <script type="text/javascript" src="../_static/effects.highlight.js" tppabs="http://www.gtan.com/akka_doc/_static/effects.highlight.js"></script>
    <script type="text/javascript" src="../_static/scrollTo.js" tppabs="http://www.gtan.com/akka_doc/_static/scrollTo.js"></script>
    <script type="text/javascript" src="../_static/contentsFix.js" tppabs="http://www.gtan.com/akka_doc/_static/contentsFix.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Akka Documentation" href="../index.html" />
    <link rel="up" title="Scala API" href="index.html" />
    <link rel="next" title="Remoting (Scala)" href="remoting.html" />
    <link rel="prev" title="Dispatchers (Scala)" href="dispatchers.html" /> 
  </head>
  <body>
  <div class="navbar">
    <div class="navbar-inner">
      <div class="container">
        <div class="navbar-logo">
          <a href="javascript:if(confirm('http://akka.io/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://akka.io/'" tppabs="http://akka.io/"><img src="../_static/logo-small.png" tppabs="http://www.gtan.com/akka_doc/_static/logo-small.png" /></a>
        </div>    
        <ul class="nav">
          <li><a href="javascript:if(confirm('http://www.gtan.com/welfare04.html  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.gtan.com/welfare04.html'" tppabs="http://www.gtan.com/welfare04.html">è¿”å›å¹¿è°ˆå…¬ç›Š</a></li>
        </ul>
      </div>
    </div>
  </div>
  <div class="main">
    <div class="container">
      <div class="page-title">è·¯ç”± (Scala)</div><div class="pdf-link"><a href="javascript:if(confirm('http://www.gtan.com/akka_doc/Akka.pdf  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ·şÎñÆ÷±¨¸æ¸ÃÎÄ¼şÎ´ÕÒµ½¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.gtan.com/akka_doc/Akka.pdf'" tppabs="http://www.gtan.com/akka_doc/Akka.pdf"><img src="../_static/pdf-icon.png" tppabs="http://www.gtan.com/akka_doc/_static/pdf-icon.png" style="height: 40px;" /></a></div></div>
    <div class="main-container">
      <div class="container">
        <div class="row">
          <div class="span12">
            <ul class="breadcrumb">           
              <li>
                 <span class="divider">|</span> <a href="remoting.html" tppabs="http://www.gtan.com/akka_doc/scala/remoting.html">è¿œç¨‹è°ƒç”¨ (Scala)</a> <span class="divider">Â»</span>
              </li>
              <li>
                <a href="../index.html" tppabs="http://www.gtan.com/akka_doc/index.html">ç›®å½•</a>
              </li>
              <li>
                <span class="divider">Â«</span> <a href="dispatchers.html" tppabs="http://www.gtan.com/akka_doc/scala/dispatchers.html">æ¶ˆæ¯æ´¾å‘å™¨ (Scala)</a> <span class="divider">|</span>
              </li>
              <li>
                ç‰ˆæœ¬ 2.0
              </li>
            </ul>         
          </div>
        </div>
        <div class="row">
          <div class="span9">
            
  <div class="section" id="routing-scala">
<span id="id1"></span><h1>è·¯ç”± (Scala)</h1>
<p> è·¯ç”±actoræ˜¯å°†æ”¶åˆ°çš„æ¶ˆæ¯è·¯ç”±åˆ°ç›®çš„actorçš„actor.
è·¯ç”±actoå°†æ¶ˆæ¯å‘é€ç»™å®ƒæ‰€ç®¡ç†çš„ç§°ä¸º &#8216;routees&#8217; çš„actor.</p>
<p>Akkaè‡ªå¸¦æœ‰ä¸€äº›å®šä¹‰å¥½çš„è·¯ç”±actor, ä½†åœ¨è¿™ä¸€ç« ä½ ä¼šå‘ç°åˆ›å»ºè‡ªå·±çš„è·¯ç”±actoréå¸¸å®¹æ˜“ã€‚Akka è‡ªå¸¦çš„è·¯ç”±actoræœ‰:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">akka.routing.RoundRobinRouter</span></tt></li>
<li><tt class="docutils literal"><span class="pre">akka.routing.RandomRouter</span></tt></li>
<li><tt class="docutils literal"><span class="pre">akka.routing.SmallestMailboxRouter</span></tt></li>
<li><tt class="docutils literal"><span class="pre">akka.routing.BroadcastRouter</span></tt></li>
<li><tt class="docutils literal"><span class="pre">akka.routing.ScatterGatherFirstCompletedRouter</span></tt></li>
</ul>
<div class="section" id="routers-in-action">
<h2>è·¯ç”±çš„ä½¿ç”¨</h2>
<p>ä¸‹ä¾‹æ¼”ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­é…ç½®çš„è·¯ç”±actor:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">deployment</span> <span class="o">{</span>
  <span class="o">/</span><span class="n">router</span> <span class="o">{</span>
    <span class="n">router</span> <span class="k">=</span> <span class="n">round</span><span class="o">-</span><span class="n">robin</span>
    <span class="n">nr</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">instances</span> <span class="k">=</span> <span class="mi">5</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">router</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">ExampleActor</span><span class="o">].</span><span class="n">withRouter</span><span class="o">(</span><span class="nc">FromConfig</span><span class="o">()),</span>
  <span class="s">&quot;router&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>ä¸‹ä¾‹æ¼”ç¤ºå¦‚ä½•ç”¨ä»£ç æ¥åˆ›å»ºè·¯ç”±actorå¹¶è®¾ç½®å®ƒæ‰€èƒ½åˆ›å»ºçš„routeesçš„æ•°é‡:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">router1</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">ExampleActor1</span><span class="o">].</span><span class="n">withRouter</span><span class="o">(</span>
  <span class="nc">RoundRobinRouter</span><span class="o">(</span><span class="n">nrOfInstances</span> <span class="k">=</span> <span class="mi">5</span><span class="o">)))</span>
</pre></div>
</div>
<p>ä½ ä¹Ÿå¯ä»¥åœ¨åˆ›å»ºè·¯ç”±actoræ—¶å°±ç»™å®š routees:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">actor1</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">ExampleActor1</span><span class="o">])</span>
<span class="k">val</span> <span class="n">actor2</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">ExampleActor1</span><span class="o">])</span>
<span class="k">val</span> <span class="n">actor3</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">ExampleActor1</span><span class="o">])</span>
<span class="k">val</span> <span class="n">routees</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">[</span><span class="kt">ActorRef</span><span class="o">](</span><span class="n">actor1</span><span class="o">,</span> <span class="n">actor2</span><span class="o">,</span> <span class="n">actor3</span><span class="o">)</span>
<span class="k">val</span> <span class="n">router2</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">ExampleActor1</span><span class="o">].</span><span class="n">withRouter</span><span class="o">(</span>
  <span class="nc">RoundRobinRouter</span><span class="o">(</span><span class="n">routees</span> <span class="k">=</span> <span class="n">routees</span><span class="o">)))</span>
</pre></div>
</div>
<p>åœ¨ç”¨ä»£ç åˆ›å»ºè·¯ç”±actoræ—¶ï¼Œä½ è¦æŒ‡å®š routees çš„æ•°é‡<em>æˆ–è€…</em> ç»™å‡ºå·²ç»åˆ›å»ºå¥½çš„ routees.
å¦‚æœä¸¤ä¸ªå‚æ•°éƒ½ç»™äº†ï¼Œ <em>åªæœ‰</em> åè€…ä¼šè¢«ä½¿ç”¨, i.e. <tt class="docutils literal"><span class="pre">nrOfInstances</span></tt> å°†è¢«å¿½ç•¥.</p>
<p><em>è¿˜å¿…é¡»æŒ‡å‡ºçš„æ˜¯å¦‚æœä½ åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰äº† ``router`` è¿™ä¸ªå€¼å°†æ¯”ä»£ç ä¸­ç»™å‡ºçš„å‚æ•°æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§.
    è€Œå…³äºæ˜¯å¦è¦åˆ›å»ºè·¯ç”±actorçš„å†³å®šï¼Œåˆ™ä¸€å®šè¦å†™åœ¨ä»£ç ä¸­ï¼Œi.e. ä½ ä¸èƒ½åªé€šè¿‡å¤–éƒ¨é…ç½®æ–‡ä»¶å°±è®©ä»€ä¹ˆä¸œè¥¿æˆä¸ºè·¯ç”±actor (è¯¦æƒ…è§ä¸‹æ–‡).</em></p>
<p>ä¸€æ—¦æœ‰äº†è·¯ç”±actorï¼Œåé¢å°±æ˜¯è±¡ç»™å…¶å®ƒactorå‘æ¶ˆæ¯ä¸€æ ·ç»™å®ƒå‘é€æ¶ˆæ¯:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">router</span> <span class="o">!</span> <span class="nc">MyMsg</span>
</pre></div>
</div>
<p>è·¯ç”±actorä¼šè¡Œä½¿å®ƒçš„åŠŸèƒ½ï¼Œå°†æ”¶åˆ°çš„æ¶ˆæ¯è½¬å‘ç»™ routee.</p>
<div class="section" id="remotely-deploying-routees">
<h3>è¿œç¨‹éƒ¨ç½² Routee</h3>
<p>é™¤äº†å¯ä»¥å°†æŸ¥æ‰¾åˆ°çš„è¿œç¨‹actorä½œä¸ºroutee, ä½ ä¹Ÿå¯ä»¥è®©è·¯ç”±actorå°†è‡ªå·±åˆ›å»ºçš„å­actoréƒ¨ç½²åˆ°ä¸€ç»„è¿œç¨‹ä¸»æœºä¸Š; è¿™æ˜¯ä»¥ round-robin çš„æ–¹å¼æ‰§è¡Œçš„.
   è¦å®Œæˆè¿™ä¸ªå·¥ä½œï¼Œå°†é…ç½®åŒ…åœ¨ <tt class="xref py py-class docutils literal"><span class="pre">RemoteRouterConfig</span></tt>ä¸­, å¹¶é™„ä¸Šä½œä¸ºéƒ¨ç½²ç›®æ ‡çš„ç»“ç‚¹çš„è¿œç¨‹
    åœ°å€. è‡ªç„¶åœ°è¿™è¦æ±‚ä½ åœ¨classpathä¸­åŒ…æ‹¬
<tt class="docutils literal"><span class="pre">akka-remote</span></tt> æ¨¡å—:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">import</span> <span class="nn">akka.actor.</span><span class="o">{</span> <span class="nc">Address</span><span class="o">,</span> <span class="nc">AddressFromURIString</span> <span class="o">}</span>
<span class="k">val</span> <span class="n">addresses</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="nc">Address</span><span class="o">(</span><span class="s">&quot;akka&quot;</span><span class="o">,</span> <span class="s">&quot;remotesys&quot;</span><span class="o">,</span> <span class="s">&quot;otherhost&quot;</span><span class="o">,</span> <span class="mi">1234</span><span class="o">),</span>
  <span class="nc">AddressFromURIString</span><span class="o">(</span><span class="s">&quot;akka://othersys@anotherhost:1234&quot;</span><span class="o">))</span>
<span class="k">val</span> <span class="n">routerRemote</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">ExampleActor1</span><span class="o">].</span><span class="n">withRouter</span><span class="o">(</span>
  <span class="nc">RemoteRouterConfig</span><span class="o">(</span><span class="nc">RoundRobinRouter</span><span class="o">(</span><span class="mi">5</span><span class="o">),</span> <span class="n">addresses</span><span class="o">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-routing-is-designed-within-akka">
<h2>Akkaä¸­çš„è·¯ç”±æ˜¯å¦‚ä½•è®¾è®¡çš„</h2>
<p>è·¯ç”±actorçš„è¡Œä¸ºè±¡ä¸€ä¸ªå•ç‹¬çš„actorï¼Œä½†å®ƒä»¬åˆä¸åº”é˜»ç¢å¯æ‰©å±•æ€§.
è§£å†³è¿™ä¸€æ˜æ˜¾çš„çŸ›ç›¾çš„æ–¹æ³•æ˜¯ç”¨ç‰¹æ®Šçš„ <tt class="xref py py-class docutils literal"><span class="pre">RoutedActorRef</span></tt>æ¥è¡¨ç¤ºè·¯ç”±actor,
    å®ƒå°†æ”¶åˆ°çš„æ¶ˆæ¯æ´¾å‘åˆ°ç›®çš„routeeä¸Šè€Œå®é™…ä¸ä¼šè°ƒç”¨è·¯ç”±çš„è¡Œä¸ºï¼ˆè¿™æ ·å°±é¿å…äº†é‚®ç®±çš„å­˜åœ¨ï¼›å•è·¯ç”±actorçš„ä»»åŠ¡æ˜¯ç®¡ç†ä¸routeeçš„ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„æ‰€æœ‰æ–¹é¢ï¼‰.
    è¿™æ„å‘³ç€å†³å®šé€‰æ‹©å“ªæ¡è·¯ç”±çš„ä»£ç æ˜¯ä¸æ‰€æœ‰å¯èƒ½çš„å‘é€æ–¹å¹¶å‘æ‰§è¡Œçš„ï¼Œå› æ­¤å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„, å®ƒä¸èƒ½ç®€å•å¿«ä¹åœ°ç”Ÿæ´»åœ¨æŸä¸ªactorä¸­ã€‚</p>
<p>ä¸Šé¢è¿™ä¸€æ®µæœ‰ä¸€éƒ¨åˆ†è¦æ±‚æˆ‘ä»¬ç»™å‡ºæ›´å¤šçš„èƒŒæ™¯è§£é‡Š: ä¸ºä»€ä¹ˆè·¯ç”±actoréœ€è¦ä¸€ä¸ª â€œheadâ€ è€Œå®ƒå…¶å®æ˜¯æ‰€æœ‰ routeeçš„çˆ¶äº²?
    æœ€åˆçš„è®¾è®¡è¯•å›¾ç»•è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯ä½ç½®é€æ˜æ€§å’Œå¼ºåˆ¶æ€§çš„çˆ¶äº²ç›‘ç®¡ä½“ç³»å¯¼è‡´å¯¹å®ƒéœ€è¦è¿›è¡Œé‡æ–°è®¾è®¡.
è·¯ç”±actoræ‰€æ´¾ç”Ÿçš„æ¯ä¸€ä¸ªactoréƒ½å¿…é¡»æ‹¥æœ‰è‡ªå·±çš„å”¯ä¸€æ ‡è¯†, è¿™ä¸€å”¯ä¸€æ ‡è¯†è¡¨ç¤ºä¸ºå”¯ä¸€çš„actorè·¯å¾„ã€‚ç”±äºè·¯ç”±actoråœ¨å…¶çˆ¶äº²çš„ä¸Šä¸‹æ–‡ä¸­åªæœ‰ä¸€ä¸ªåå­—,
    å› æ­¤å‘½åç©ºé—´ä¸­éœ€è¦å¦ä¸€ä¸ªçº§åˆ«, æŒ‰ç…§å¯»å€è¯­ä¹‰ï¼Œè¿™ä¸ªçº§åˆ«æ„å‘³ç€éœ€è¦æœ‰ä»¥è·¯ç”±actorä¹‹åä¸ºåçš„actorçš„å­˜åœ¨ã€‚è¿™ä¸ä»…æ˜¯åœ¨åˆ›å»ºã€é‡å¯å’Œç»ˆæ­¢actoræ—¶çš„å†…éƒ¨æ¶ˆæ¯æœºåˆ¶çš„éœ€è¦, ä¹Ÿæ˜¯actoræ± ä¸­çš„actorä¸å…¶å®ƒactorå¯¹è¯å¹¶ä»¥ç¡®å®šçš„æ–¹å¼æ¥æ”¶åº”ç­”çš„éœ€è¦.
    ç”±äºæ¯ä¸ªactorçŸ¥é“è‡ªå·±åŠå…¶çˆ¶äº²çš„å¤–éƒ¨è¡¨ç¤º, æ‰€ä»¥routeesåœ¨å¯¹æ¶ˆæ¯è¿›è¡Œå“åº”æ—¶èƒ½å¤Ÿç¡®å®šåº”ç­”å‘é€åˆ°å“ªé‡Œ:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">sender</span><span class="o">.</span><span class="n">tell</span><span class="o">(</span><span class="s">&quot;reply&quot;</span><span class="o">,</span> <span class="n">context</span><span class="o">.</span><span class="n">parent</span><span class="o">)</span> <span class="c1">// åº”ç­”ä¼šå‘è¿˜ç»™çˆ¶äº²</span>
<span class="n">sender</span><span class="o">.!(</span><span class="s">&quot;reply&quot;</span><span class="o">)(</span><span class="n">context</span><span class="o">.</span><span class="n">parent</span><span class="o">)</span> <span class="c1">// å¦ä¸€ç§è¯­æ³• (æ³¨æ„æ‹¬å·!)</span>
</pre></div>
</div>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">sender</span> <span class="o">!</span> <span class="n">x</span> <span class="c1">// åº”ç­”ä¼šå‘ç»™è¿™ä¸ªactor</span>
</pre></div>
</div>
<p>ç°åœ¨å¤§å®¶å°±èƒ½æ˜ç™½ä¸ºä»€ä¹ˆè·¯ç”±éœ€è¦åœ¨ä»£ç æœ€åˆå°±å¼€å¯è€Œä¸å¯èƒ½ä»¥åå†â€œæ‹§ä¸Šâ€: ä¸€ä¸ªactoræ˜¯å¦è¦è¿›è¡Œè·¯ç”±ä¼šæ”¹å˜actorçš„å±‚æ¬¡ï¼Œæ”¹å˜è·¯ç”±actoræ‰€æœ‰å­actor
    çš„è·¯å¾„ã€‚æ‰€æœ‰çš„routeeç‰¹åˆ«éœ€è¦çŸ¥é“æ˜¯è°ä¸ºå®ƒä»¬åšçš„å¯»è·¯ä»¥ä¾¿é€‰æ‹©å®ƒä»¬æ‰€æ´¾å‘çš„æ¶ˆæ¯çš„å‘é€å¼•ç”¨ï¼Œå¦‚ä¸Šä¾‹ã€‚
</p>
</div>
<div class="section" id="routers-vs-supervision">
<h2>è·¯ç”±actor vs. ç›‘ç®¡è€…</h2>
<p>å¦‚ä¸Šä¸€éƒ¨åˆ†æ‰€è¿°ï¼Œè·¯ç”±actoråˆ›å»ºå…¶â€œhead"è·¯ç”±çš„çš„å­actorå®ä¾‹ï¼Œä»è€Œâ€œheadâ€œæˆä¸ºè¿™äº›å­actorçš„ç›‘ç®¡è€…ã€‚ è¿™ä¸ªactorçš„ç›‘ç®¡ç­–ç•¥å¯ä»¥ä½¿ç”¨
<tt class="xref py py-meth docutils literal"><span class="pre">RouterConfig.supervisorStrategy</span></tt> å±æ€§æ¥é…ç½®,
    è¿™ä¸ªå±æ€§è¢«æ‰€æœ‰è‡ªå¸¦çš„è·¯ç”±ç±»å‹æ‰€æ”¯æŒ. ç¼ºçœçš„è¡Œä¸ºæ˜¯ â€œæ€»æ˜¯ä¸Šæº¯â€, è¿™æ ·è·¯ç”±actorçš„çˆ¶äº²å°±èƒ½ç»Ÿä¸€åœ°ç›´æ¥ç›‘ç®¡è·¯ç”±actorçš„å­actor (i.e. å¹¶ä¸æ˜¯åªæ˜¯å‡ºé”™çš„é‚£ä¸€ä¸ª).
    å¿…é¡»æŒ‡å‡ºè·¯ç”±actoré‡å†™äº†åœ¨é‡å¯æ—¶ç»ˆæ­¢æ‰€æœ‰å­actorçš„ç¼ºçœè¡Œä¸ºï¼Œè¿™æ„å‘³ç€é‡å¯â€”â€”åŒæ—¶é‡æ–°åˆ›å»ºå®ƒä»¬â€”â€”å¹¶ä¸å½±å“æ± ä¸­çš„actoræ•°é‡</p>
<p>è®¾ç½®ç­–ç•¥çš„æ–¹æ³•å¾ˆç®€å•:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">escalator</span> <span class="k">=</span> <span class="nc">OneForOneStrategy</span><span class="o">()</span> <span class="o">{</span>
  <span class="c1">// è‡ªå®šä¹‰ç­–ç•¥ ...</span>
<span class="o">}</span>
<span class="k">val</span> <span class="n">router</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">.</span><span class="n">empty</span><span class="o">.</span><span class="n">withRouter</span><span class="o">(</span>
  <span class="nc">RoundRobinRouter</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">supervisorStrategy</span> <span class="k">=</span> <span class="n">escalator</span><span class="o">)))</span>
</pre></div>
</div>
<p>å¦ä¸€ä¸ªå¯èƒ½æœ‰ç”¨çš„æ–¹æ³•æ˜¯ä¸ºè·¯ç”±actorè®¾ç½®ä¸å…¶çˆ¶äº²ä¸€æ ·çš„ç­–ç•¥ï¼Œè¿™æ ·æ± ä¸­çš„actorå°±è±¡æ˜¯å…¶ç¥–çˆ¶çš„ç›´æ¥å­actorä¸€æ ·ã€‚</p>
</div>
<div class="section" id="router-usage">
<h2>è·¯ç”±actorçš„ä½¿ç”¨</h2>
<p>è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬ä»‹ç»å¦‚ä½•ä½¿ç”¨ä¸åŒç±»å‹çš„è·¯ç”±ç±»å‹.
é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¾‹å­ä¸­è¦ä½¿ç”¨çš„actor:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">class</span> <span class="nc">PrintlnActor</span> <span class="k">extends</span> <span class="nc">Actor</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">receive</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">case</span> <span class="n">msg</span> <span class="k">â‡’</span>
      <span class="n">println</span><span class="o">(</span><span class="s">&quot;Received message &#39;%s&#39; in actor %s&quot;</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="n">msg</span><span class="o">,</span> <span class="n">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>å’Œ</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">class</span> <span class="nc">FibonacciActor</span> <span class="k">extends</span> <span class="nc">Actor</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">receive</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">FibonacciNumber</span><span class="o">(</span><span class="n">nbr</span><span class="o">)</span> <span class="k">â‡’</span> <span class="n">sender</span> <span class="n">tell</span> <span class="n">fibonacci</span><span class="o">(</span><span class="n">nbr</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">private</span> <span class="k">def</span> <span class="n">fibonacci</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nd">@tailrec</span>
    <span class="k">def</span> <span class="n">fib</span><span class="o">(</span><span class="n">n</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">a</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="n">n</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="mi">0</span> <span class="k">â‡’</span> <span class="n">a</span>
      <span class="k">case</span> <span class="k">_</span> <span class="k">â‡’</span> <span class="n">fib</span><span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span>
    <span class="o">}</span>

    <span class="n">fib</span><span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="section" id="roundrobinrouter">
<h3>RoundRobinRouter</h3>
<p>ä»¥ <a class="reference external" href="javascript:if(confirm('http://en.wikipedia.org/wiki/Round-robin  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://en.wikipedia.org/wiki/Round-robin'" tppabs="http://en.wikipedia.org/wiki/Round-robin">round-robin</a> æ–¹å¼è·¯ç”±åˆ° routee.
ä»£ç ç¤ºä¾‹:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">roundRobinRouter</span> <span class="k">=</span>
  <span class="n">context</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">PrintlnActor</span><span class="o">].</span><span class="n">withRouter</span><span class="o">(</span><span class="nc">RoundRobinRouter</span><span class="o">(</span><span class="mi">5</span><span class="o">)),</span> <span class="s">&quot;router&quot;</span><span class="o">)</span>
<span class="mi">1</span> <span class="n">to</span> <span class="mi">10</span> <span class="n">foreach</span> <span class="o">{</span>
  <span class="n">i</span> <span class="k">â‡’</span> <span class="n">roundRobinRouter</span> <span class="o">!</span> <span class="n">i</span>
<span class="o">}</span>
</pre></div>
</div>
<p>è¿è¡Œä»¥ä¸Šä»£ç ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼š</p>
<div class="highlight-scala"><pre>Received message '1' in actor $b
Received message '2' in actor $c
Received message '3' in actor $d
Received message '6' in actor $b
Received message '4' in actor $e
Received message '8' in actor $d
Received message '5' in actor $f
Received message '9' in actor $e
Received message '10' in actor $f
Received message '7' in actor $c</pre>
</div>
<p>å¦‚æœä»”ç»†è§‚å¯Ÿè¾“å‡ºç»“æœä½ ä¼šå‘ç°æ¯ä¸€ä¸ªrouteeæ”¶åˆ°ä¸¤ä¸ªæ¶ˆæ¯ï¼Œè€Œè¿™æ­£æ˜¯ round-robin è·¯ç”±æ–¹å¼çš„é¢„æœŸè¡Œä¸º.
(actor çš„åå­—æ˜¯ä»¥ <tt class="docutils literal"><span class="pre">$letter</span></tt> çš„æ ¼å¼è‡ªåŠ¨åˆ›å»ºçš„ï¼ˆå¦‚æœä½ æ²¡æœ‰æŒ‡å®šï¼‰ï¼Œ
æ‰€ä»¥ä¼šå‡ºæ¥ä¸Šé¢è¿™äº›åå­—.)</p>
</div>
<div class="section" id="randomrouter">
<h3>RandomRouter</h3>
<p>å¦‚å…¶åå­—æ‰€ç¤ºï¼Œè¿™ä¸ªè·¯ç”±ç±»å‹éšæœºé€‰å–ä¸€ä¸ªrouteeä½œä¸ºè½¬å‘æ¶ˆæ¯çš„ç›®æ ‡.æ¯æ”¶åˆ°ä¸€ä¸ªæ¶ˆæ¯å°±ä¼šè¿›è¡Œä¸€æ¬¡é€‰æ‹©.
ä»£ç ç¤ºä¾‹:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">randomRouter</span> <span class="k">=</span>
  <span class="n">context</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">PrintlnActor</span><span class="o">].</span><span class="n">withRouter</span><span class="o">(</span><span class="nc">RandomRouter</span><span class="o">(</span><span class="mi">5</span><span class="o">)),</span> <span class="s">&quot;router&quot;</span><span class="o">)</span>
<span class="mi">1</span> <span class="n">to</span> <span class="mi">10</span> <span class="n">foreach</span> <span class="o">{</span>
  <span class="n">i</span> <span class="k">â‡’</span> <span class="n">randomRouter</span> <span class="o">!</span> <span class="n">i</span>
<span class="o">}</span>
</pre></div>
</div>
<p>è¿è¡Œä»¥ä¸Šä»£ç ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡º:</p>
<div class="highlight-scala"><pre>Received message '1' in actor $e
Received message '2' in actor $c
Received message '4' in actor $b
Received message '5' in actor $d
Received message '3' in actor $e
Received message '6' in actor $c
Received message '7' in actor $d
Received message '8' in actor $e
Received message '9' in actor $d
Received message '10' in actor $d</pre>
</div>
<p>è¿è¡Œéšæœºè·¯ç”±çš„ç»“æœæ¯æ¬¡å„ä¸ç›¸åŒ, æˆ–è€…è‡³å°‘æ˜¯éšæœºçš„. å¦‚æœä½ ä¸ä¿¡ä»»æˆ‘ä»¬ä½ å¯ä»¥å¤šè¿è¡Œå‡ æ¬¡ã€‚</p>
</div>
<div class="section" id="smallestmailboxrouter">
<h3>SmallestMailboxRouter</h3>
<p>é€‰æ‹©æœªæŒ‚èµ·çš„é‚®ç®±ä¸­æ¶ˆæ¯æ•°æœ€å°‘çš„routee.
é€‰æ‹©çš„é¡ºåºå¦‚ä¸‹:</p>
<blockquote>
<div><ul class="simple">
<li>é€‰å–ä»»ä½•ä¸€ä¸ªç©ºé—²çš„ï¼ˆæ²¡æœ‰æ­£åœ¨å¤„ç†çš„æ¶ˆæ¯ï¼‰é‚®ç®±ä¸ºç©ºçš„ routee </li>
<li>é€‰æ‹©ä»»ä½•é‚®ç®±ä¸ºç©ºçš„routee </li>
<li>é€‰æ‹©é‚®ç®±ä¸­ç­‰å¾…çš„æ¶ˆæ¯æœ€å°‘çš„ routee</li>
<li>é€‰æ‹©ä»»ä½•ä¸€ä¸ªè¿œç¨‹ routee, ç”±äºé‚®ç®±å¤§å°æœªçŸ¥ï¼Œè¿œç¨‹actorè¢«è®¤ä¸ºå…·æœ‰ä½ä¼˜å…ˆçº§</li>
</ul>
</div></blockquote>
<p>ä»£ç ç¤ºä¾‹:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">smallestMailboxRouter</span> <span class="k">=</span>
  <span class="n">context</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">PrintlnActor</span><span class="o">].</span><span class="n">withRouter</span><span class="o">(</span><span class="nc">SmallestMailboxRouter</span><span class="o">(</span><span class="mi">5</span><span class="o">)),</span> <span class="s">&quot;router&quot;</span><span class="o">)</span>
<span class="mi">1</span> <span class="n">to</span> <span class="mi">10</span> <span class="n">foreach</span> <span class="o">{</span>
  <span class="n">i</span> <span class="k">â‡’</span> <span class="n">smallestMailboxRouter</span> <span class="o">!</span> <span class="n">i</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="broadcastrouter">
<h3>BroadcastRouter</h3>
<p>å°†æ¶ˆæ¯è½¬å‘ç»™ <em>æ‰€æœ‰</em> routees.
ä»£ç ç¤ºä¾‹:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">broadcastRouter</span> <span class="k">=</span>
  <span class="n">context</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">PrintlnActor</span><span class="o">].</span><span class="n">withRouter</span><span class="o">(</span><span class="nc">BroadcastRouter</span><span class="o">(</span><span class="mi">5</span><span class="o">)),</span> <span class="s">&quot;router&quot;</span><span class="o">)</span>
<span class="n">broadcastRouter</span> <span class="o">!</span> <span class="s">&quot;this is a broadcast message&quot;</span>
</pre></div>
</div>
<p>è¿è¡Œä»¥ä¸Šä»£ç ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡º:</p>
<div class="highlight-scala"><pre>Received message 'this is a broadcast message' in actor $f
Received message 'this is a broadcast message' in actor $d
Received message 'this is a broadcast message' in actor $e
Received message 'this is a broadcast message' in actor $c
Received message 'this is a broadcast message' in actor $b</pre>
</div>
<p>å¯ä»¥çœ‹åˆ°æ‰€æœ‰äº”ä¸ªrouteeéƒ½æ”¶åˆ°äº†å¹¿æ’­æ¶ˆæ¯.</p>
</div>
<div class="section" id="scattergatherfirstcompletedrouter">
<h3>ScatterGatherFirstCompletedRouter</h3>
<p>å°†æ¶ˆæ¯ä½œä¸ºä¸€ä¸ªfutureå‘é€ç»™æ‰€æœ‰çš„ routees. ç„¶åç­‰å¾…å›é€çš„ç¬¬ä¸€ä¸ªç»“æœã€‚è¿™ä¸ªç»“æœå°†è¢«å‘è¿˜ç»™æœ€åˆçš„å‘é€è€…ã€‚
ä»£ç ç¤ºä¾‹:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">scatterGatherFirstCompletedRouter</span> <span class="k">=</span> <span class="n">context</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span>
  <span class="nc">Props</span><span class="o">[</span><span class="kt">FibonacciActor</span><span class="o">].</span><span class="n">withRouter</span><span class="o">(</span><span class="nc">ScatterGatherFirstCompletedRouter</span><span class="o">(</span>
    <span class="n">nrOfInstances</span> <span class="k">=</span> <span class="mi">5</span><span class="o">,</span> <span class="n">within</span> <span class="k">=</span> <span class="mi">2</span> <span class="n">seconds</span><span class="o">)),</span> <span class="s">&quot;router&quot;</span><span class="o">)</span>
<span class="k">implicit</span> <span class="k">val</span> <span class="n">timeout</span> <span class="k">=</span> <span class="nc">Timeout</span><span class="o">(</span><span class="mi">5</span> <span class="n">seconds</span><span class="o">)</span>
<span class="k">val</span> <span class="n">futureResult</span> <span class="k">=</span> <span class="n">scatterGatherFirstCompletedRouter</span> <span class="o">?</span> <span class="nc">FibonacciNumber</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="nc">Await</span><span class="o">.</span><span class="n">result</span><span class="o">(</span><span class="n">futureResult</span><span class="o">,</span> <span class="n">timeout</span><span class="o">.</span><span class="n">duration</span><span class="o">)</span>
</pre></div>
</div>
<p>è¿è¡Œä»¥ä¸Šä»£ç ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡º:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">The</span> <span class="n">result</span> <span class="n">of</span> <span class="n">calculating</span> <span class="nc">Fibonacci</span> <span class="k">for</span> <span class="mi">10</span> <span class="n">is</span> <span class="mi">55</span>
</pre></div>
</div>
<p>ä»ä»¥ä¸Šè¾“å‡ºå¹¶æ— æ³•ç¡®å®šæ‰€æœ‰çš„routeeéƒ½è¿›è¡Œäº†è®¡ç®—ï¼Œä½†æ˜¯ä»–ä»¬åšäº†ï¼ä½ çœ‹åˆ°çš„ç»“æœæ¥è‡ªç¬¬ä¸€ä¸ªå°†è®¡ç®—ç»“æœå‘ç»™è·¯ç”±actorçš„routee.</p>
</div>
</div>
<div class="section" id="broadcast-messages">
<h2>å¹¿æ’­æ¶ˆæ¯</h2>
<p>æœ‰ä¸€ç±»ç‰¹æ®Šçš„æ¶ˆæ¯ï¼Œä¸ç®¡æ˜¯å“ªç§è·¯ç”±actorï¼Œéƒ½ä¼šè¢«å¹¿æ’­ç»™æ‰€æœ‰çš„routee.
è¿™ç§æ¶ˆæ¯è¢«ç§°ä¸º <tt class="docutils literal"><span class="pre">Broadcast</span></tt> ï¼Œç”¨ä»¥ä¸‹çš„æ–¹æ³•ä½¿ç”¨:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">router</span> <span class="o">!</span> <span class="nc">Broadcast</span><span class="o">(</span><span class="s">&quot;Watch out for Davy Jones&#39; locker&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>åªæœ‰å®é™…çš„æ¶ˆæ¯è¢«è½¬å‘åˆ° routees, i.e. ä¸Šä¾‹ä¸­çš„&#8220;Watch out for Davy Jones&#8217; locker&#8221; .
æ˜¯å¦è¦å¤„ç†å¹¿æ’­æ¶ˆæ¯ç”±routeeçš„å®ç°å†³å®šã€‚<p>
</div>
<div class="section" id="dynamically-resizable-routers">
<h2>åŠ¨æ€æ”¹å˜routeeæ•°é‡çš„è·¯ç”±actor</h2>
<p>æ‰€æœ‰çš„è·¯ç”±actorå¯ä»¥æ‹¥æœ‰å›ºå®šæ•°é‡çš„routeesæˆ–è€…ä¹Ÿå¯ä»¥æœ‰ä¸€ä¸ªæ”¹å˜å¤§å°çš„ç­–ç•¥æ¥åŠ¨æ€è°ƒæ•´routeesçš„æ•°é‡.</p>
<p>ä¸‹é¢æ˜¯å¦‚ä½•åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­çš„å¯å˜æ•°é‡çš„è·¯ç”±:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">deployment</span> <span class="o">{</span>
  <span class="o">/</span><span class="n">router2</span> <span class="o">{</span>
    <span class="n">router</span> <span class="k">=</span> <span class="n">round</span><span class="o">-</span><span class="n">robin</span>
    <span class="n">resizer</span> <span class="o">{</span>
      <span class="n">lower</span><span class="o">-</span><span class="n">bound</span> <span class="k">=</span> <span class="mi">2</span>
      <span class="n">upper</span><span class="o">-</span><span class="n">bound</span> <span class="k">=</span> <span class="mi">15</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">router2</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">ExampleActor</span><span class="o">].</span><span class="n">withRouter</span><span class="o">(</span><span class="nc">FromConfig</span><span class="o">()),</span>
  <span class="s">&quot;router2&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>æ›´å¤šé…ç½®é€‰é¡¹è§ <a class="reference internal" href="../general/configuration.html#configuration" tppabs="http://www.gtan.com/akka_doc/general/configuration.html#configuration"><em>Configuration</em></a> çš„ <tt class="docutils literal"><span class="pre">akka.actor.deployment.default.resizer</span></tt>
éƒ¨åˆ†.</p>
<p>ä¸‹é¢æ˜¯å¦‚ä½•ç”¨ä»£ç åˆ›å»ºä¸€ä¸ªå¯æ”¹å˜routeeæ•°é‡çš„è·¯ç”±actorçš„ç¤ºä¾‹:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">resizer</span> <span class="k">=</span> <span class="nc">DefaultResizer</span><span class="o">(</span><span class="n">lowerBound</span> <span class="k">=</span> <span class="mi">2</span><span class="o">,</span> <span class="n">upperBound</span> <span class="k">=</span> <span class="mi">15</span><span class="o">)</span>
<span class="k">val</span> <span class="n">router3</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">ExampleActor1</span><span class="o">].</span><span class="n">withRouter</span><span class="o">(</span>
  <span class="nc">RoundRobinRouter</span><span class="o">(</span><span class="n">resizer</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="n">resizer</span><span class="o">))))</span>
</pre></div>
</div>
<p><em>éœ€è¦æŒ‡å‡ºå¦‚æœä½ åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰äº† ``router`` é‚£ä¹ˆè¿™ä¸ªå€¼å°†æ¯”åœ¨ä»£ç ä¸­ä¼ å…¥çš„å‚æ•°æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§.</em></p>
<div class="admonition note">
<p class="first admonition-title">æ³¨æ„</p>
<p class="last">æ”¹å˜å¤§å°çš„è¡Œä¸ºæ˜¯é€šè¿‡å‘actoræ± å‘é€æ¶ˆæ¯æ¥è§¦å‘çš„, ä½†å®ƒä¸æ˜¯å®Œå…¨åŒæ­¥çš„; è€Œæ˜¯å‘
<tt class="xref py py-class docutils literal"><span class="pre">Router</span></tt>çš„â€œheadâ€å‘é€æ¶ˆæ¯æ¥æ‰§è¡Œä¿®æ”¹.
    æ‰€ä»¥åœ¨åˆ«çš„actorå¿™ç¢Œæ—¶ï¼Œä½ ä¸èƒ½å‡è®¾æ”¹å˜å¤§å°çš„æ“ä½œä¼šç«‹å³åˆ›å»ºæ–°çš„å·¥ä½œactorï¼Œå› ä¸ºæ¶ˆæ¯ä¼šè¢«å‘åˆ°å¿™ç¢Œçš„actorçš„é‚®ç®±ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé…ç½®actoræ± 
    ä½¿ç”¨ä¸€ä¸ªå¹³è¡¡çš„æ´¾å‘å™¨ï¼Œæ›´å¤šä¿¡æ¯è§ <a class="reference internal" href="#configuring-dispatchers">Configuring
Dispatchers</a> .</p>
</div>
</div>
<div class="section" id="custom-router">
<h2>è‡ªå®šä¹‰è·¯ç”±actor</h2>
<p>å¦‚æœè§‰å¾—Akkaè‡ªå¸¦çš„è·¯ç”±actoréƒ½ä¸åˆç”¨ï¼Œä½ ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„è·¯ç”±actor.
è¦åˆ›å»ºè‡ªå·±çš„è·¯ç”±ï¼Œä½ éœ€è¦æ»¡è¶³è¿™ä¸€éƒ¨åˆ†æ‰€åˆ—å‡ºçš„æ¡ä»¶.</p>
<p>æœ¬ä¾‹ä¸­çš„è·¯ç”±actoræ˜¯ä¸€ä¸ªç®€å•çš„æŠ•ç¥¨è®¡æ•°å™¨. å®ƒä¼šå°†æŠ•ç¥¨è·¯ç”±åˆ°ç‰¹å®šçš„æŠ•ç¥¨è®¡æ•°actor. è¿™é‡Œæˆ‘ä»¬åªæœ‰ä¸¤ä¸ªå…šæ´¾æ°‘ä¸»å…šå’Œå…±å’Œå…šã€‚æˆ‘ä»¬å¸Œæœ›è·¯ç”±actor
    å°†æ‰€æœ‰æ°‘ä¸»ç›¸å…³çš„æ¶ˆæ¯è½¬å‘åˆ°æ°‘ä¸»å…šactorï¼Œæ‰€æœ‰å…±å’Œå…šç›¸å…³çš„æ¶ˆæ¯è½¬å‘åˆ°å…±å’Œå…šactor.</p>
<p>å…ˆå®šä¹‰ç±»:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">case</span> <span class="k">class</span> <span class="nc">VoteCountRouter</span><span class="o">()</span> <span class="k">extends</span> <span class="nc">RouterConfig</span> <span class="o">{</span>

  <span class="k">def</span> <span class="n">routerDispatcher</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">Dispatchers</span><span class="o">.</span><span class="nc">DefaultDispatcherId</span>
  <span class="k">def</span> <span class="n">supervisorStrategy</span><span class="k">:</span> <span class="kt">SupervisorStrategy</span> <span class="o">=</span> <span class="nc">SupervisorStrategy</span><span class="o">.</span><span class="n">defaultStrategy</span>

  <span class="c1">// crRoute ...</span>

<span class="o">}</span>
</pre></div>
</div>
<p>ä¸‹ä¸€æ­¥æ˜¯å®ç°ä¸Šç±»ä¸­çš„ <tt class="docutils literal"><span class="pre">createRoute</span></tt> æ–¹æ³•:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">def</span> <span class="n">createRoute</span><span class="o">(</span><span class="n">routeeProps</span><span class="k">:</span> <span class="kt">Props</span><span class="o">,</span> <span class="n">routeeProvider</span><span class="k">:</span> <span class="kt">RouteeProvider</span><span class="o">)</span><span class="k">:</span> <span class="kt">Route</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">democratActor</span> <span class="k">=</span> <span class="n">routeeProvider</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">(</span><span class="k">new</span> <span class="nc">DemocratActor</span><span class="o">()),</span> <span class="s">&quot;d&quot;</span><span class="o">)</span>
  <span class="k">val</span> <span class="n">republicanActor</span> <span class="k">=</span> <span class="n">routeeProvider</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">(</span><span class="k">new</span> <span class="nc">RepublicanActor</span><span class="o">()),</span> <span class="s">&quot;r&quot;</span><span class="o">)</span>
  <span class="k">val</span> <span class="n">routees</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">[</span><span class="kt">ActorRef</span><span class="o">](</span><span class="n">democratActor</span><span class="o">,</span> <span class="n">republicanActor</span><span class="o">)</span>

  <span class="n">routeeProvider</span><span class="o">.</span><span class="n">registerRoutees</span><span class="o">(</span><span class="n">routees</span><span class="o">)</span>

  <span class="o">{</span>
    <span class="k">case</span> <span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">message</span><span class="o">)</span> <span class="k">â‡’</span>
      <span class="n">message</span> <span class="k">match</span> <span class="o">{</span>
        <span class="k">case</span> <span class="nc">DemocratVote</span> <span class="o">|</span> <span class="nc">DemocratCountResult</span> <span class="k">â‡’</span>
          <span class="nc">List</span><span class="o">(</span><span class="nc">Destination</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">democratActor</span><span class="o">))</span>
        <span class="k">case</span> <span class="nc">RepublicanVote</span> <span class="o">|</span> <span class="nc">RepublicanCountResult</span> <span class="k">â‡’</span>
          <span class="nc">List</span><span class="o">(</span><span class="nc">Destination</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">republicanActor</span><span class="o">))</span>
      <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>å¦‚ä¸Šæ‰€ç¤ºæˆ‘ä»¬å°†åˆ›å»ºçš„ routees æ”¾è¿›ä¸€ä¸ªé›†åˆ.</p>
<p>è¯·ç¡®è®¤ä½ æ²¡æœ‰æ¼æ‰ä¸‹é¢è¿™ä¸€è¡Œå› ä¸ºå®ƒ <em>éå¸¸</em> é‡è¦.
å®ƒå°†routeeè¿›è¡Œå†…éƒ¨æ³¨å†Œï¼Œå¦‚æœæ²¡æœ‰è°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¼šå¯¼è‡´ä½¿ç”¨è·¯ç”±æ—¶æŠ›å‡º <tt class="docutils literal"><span class="pre">ActorInitializationException</span></tt> .
æ‰€ä»¥è¦ä½ çš„è‡ªå®šä¹‰è·¯ç”±ä¸­ä¸€å®šè¦åšä¸‹é¢çš„äº‹ï¼š</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">routeeProvider</span><span class="o">.</span><span class="n">registerRoutees</span><span class="o">(</span><span class="n">routees</span><span class="o">)</span>
</pre></div>
</div>
<p>è·¯ç”±é€»è¾‘æ˜¯ä½ çš„é­”æ³•èµ·ä½œç”¨çš„åœ°æ–¹. åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­å®ƒåˆ†ææ¶ˆæ¯çš„ç±»å‹å¹¶æ ¹æ®ç±»å‹å°†æ¶ˆæ¯è½¬å‘åˆ°æ­£ç¡®çš„routee:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="o">{</span>
  <span class="k">case</span> <span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">message</span><span class="o">)</span> <span class="k">â‡’</span>
    <span class="n">message</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">DemocratVote</span> <span class="o">|</span> <span class="nc">DemocratCountResult</span> <span class="k">â‡’</span>
        <span class="nc">List</span><span class="o">(</span><span class="nc">Destination</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">democratActor</span><span class="o">))</span>
      <span class="k">case</span> <span class="nc">RepublicanVote</span> <span class="o">|</span> <span class="nc">RepublicanCountResult</span> <span class="k">â‡’</span>
        <span class="nc">List</span><span class="o">(</span><span class="nc">Destination</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">republicanActor</span><span class="o">))</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹åˆ°åå‡½æ•°ä¸­è¿”å›çš„æ˜¯ä¸€ä¸ª <tt class="docutils literal"><span class="pre">Destination(sender,</span> <span class="pre">routee)</span></tt> çš„<tt class="docutils literal"><span class="pre">List</span></tt> .
å‘é€æ–¹æ˜¯routeeåº”çœ‹åˆ°çš„é‚£ä¸ª &#8220;parent&#8221; the routee should see - å¦‚æœä½ å¸Œæœ›å¦ä¸€ä¸ªactorè€Œä¸æ˜¯åŸå§‹çš„å‘é€è€…å¯¹routeeçš„è¿”å›ç»“æœï¼ˆå¦‚æœæœ‰è¿”å›ç»“æœçš„è¯ï¼‰è¿›è¡Œä¸­é—´å¹²é¢„ï¼Œå¯ä»¥æ”¹å˜è¿™ä¸ªå€¼.
è¦äº†è§£å¦‚ä½•æ”¹å˜åŸå§‹çš„å‘é€è€…çš„æ›´å¤šä¿¡æ¯è¯·å‚è€ƒ
<a class="reference external" href="javascript:if(confirm('https://github.com/akka/akka/blob/master/akka-actor/src/main/scala/akka/routing/Routing.scala  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/akka/akka/blob/master/akka-actor/src/main/scala/akka/routing/Routing.scala#L375'" tppabs="https://github.com/akka/akka/blob/master/akka-actor/src/main/scala/akka/routing/Routing.scala#L375">ScatterGatherFirstCompletedRouter</a></p>
<p>ä¸€ä¸ªå®Œæ•´çš„è·¯ç”±actoré•¿å¾—è±¡è¿™æ ·:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">case</span> <span class="k">object</span> <span class="nc">DemocratVote</span>
<span class="k">case</span> <span class="k">object</span> <span class="nc">DemocratCountResult</span>
<span class="k">case</span> <span class="k">object</span> <span class="nc">RepublicanVote</span>
<span class="k">case</span> <span class="k">object</span> <span class="nc">RepublicanCountResult</span>

<span class="k">class</span> <span class="nc">DemocratActor</span> <span class="k">extends</span> <span class="nc">Actor</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">counter</span> <span class="k">=</span> <span class="mi">0</span>

  <span class="k">def</span> <span class="n">receive</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">DemocratVote</span>        <span class="k">â‡’</span> <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">case</span> <span class="nc">DemocratCountResult</span> <span class="k">â‡’</span> <span class="n">sender</span> <span class="o">!</span> <span class="n">counter</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">RepublicanActor</span> <span class="k">extends</span> <span class="nc">Actor</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">counter</span> <span class="k">=</span> <span class="mi">0</span>

  <span class="k">def</span> <span class="n">receive</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">RepublicanVote</span>        <span class="k">â‡’</span> <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">case</span> <span class="nc">RepublicanCountResult</span> <span class="k">â‡’</span> <span class="n">sender</span> <span class="o">!</span> <span class="n">counter</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">VoteCountRouter</span><span class="o">()</span> <span class="k">extends</span> <span class="nc">RouterConfig</span> <span class="o">{</span>

  <span class="k">def</span> <span class="n">routerDispatcher</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="nc">Dispatchers</span><span class="o">.</span><span class="nc">DefaultDispatcherId</span>
  <span class="k">def</span> <span class="n">supervisorStrategy</span><span class="k">:</span> <span class="kt">SupervisorStrategy</span> <span class="o">=</span> <span class="nc">SupervisorStrategy</span><span class="o">.</span><span class="n">defaultStrategy</span>

  <span class="k">def</span> <span class="n">createRoute</span><span class="o">(</span><span class="n">routeeProps</span><span class="k">:</span> <span class="kt">Props</span><span class="o">,</span> <span class="n">routeeProvider</span><span class="k">:</span> <span class="kt">RouteeProvider</span><span class="o">)</span><span class="k">:</span> <span class="kt">Route</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">democratActor</span> <span class="k">=</span> <span class="n">routeeProvider</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">(</span><span class="k">new</span> <span class="nc">DemocratActor</span><span class="o">()),</span> <span class="s">&quot;d&quot;</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">republicanActor</span> <span class="k">=</span> <span class="n">routeeProvider</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">(</span><span class="k">new</span> <span class="nc">RepublicanActor</span><span class="o">()),</span> <span class="s">&quot;r&quot;</span><span class="o">)</span>
    <span class="k">val</span> <span class="n">routees</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">[</span><span class="kt">ActorRef</span><span class="o">](</span><span class="n">democratActor</span><span class="o">,</span> <span class="n">republicanActor</span><span class="o">)</span>

    <span class="n">routeeProvider</span><span class="o">.</span><span class="n">registerRoutees</span><span class="o">(</span><span class="n">routees</span><span class="o">)</span>

    <span class="o">{</span>
      <span class="k">case</span> <span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">message</span><span class="o">)</span> <span class="k">â‡’</span>
        <span class="n">message</span> <span class="k">match</span> <span class="o">{</span>
          <span class="k">case</span> <span class="nc">DemocratVote</span> <span class="o">|</span> <span class="nc">DemocratCountResult</span> <span class="k">â‡’</span>
            <span class="nc">List</span><span class="o">(</span><span class="nc">Destination</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">democratActor</span><span class="o">))</span>
          <span class="k">case</span> <span class="nc">RepublicanVote</span> <span class="o">|</span> <span class="nc">RepublicanCountResult</span> <span class="k">â‡’</span>
            <span class="nc">List</span><span class="o">(</span><span class="nc">Destination</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">republicanActor</span><span class="o">))</span>
        <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<p>å¦‚æœä½ æœ‰å…´è¶£äº†è§£å¦‚ä½•ä½¿ç”¨ VoteCountRouter å¯ä»¥çœ‹ä¸€ä¸‹æµ‹è¯•ç±»
<a class="reference external" href="javascript:if(confirm('https://github.com/akka/akka/blob/master/akka-actor-tests/src/test/scala/akka/routing/RoutingSpec.scala  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/akka/akka/blob/master/akka-actor-tests/src/test/scala/akka/routing/RoutingSpec.scala'" tppabs="https://github.com/akka/akka/blob/master/akka-actor-tests/src/test/scala/akka/routing/RoutingSpec.scala">RoutingSpec</a></p>
<div class="section" id="configured-custom-router">
<h3>é…ç½®è‡ªå®šä¹‰è·¯ç”±Actor</h3>
<p>å¯ä»¥è¢«è‡ªå®šä¹‰è·¯ç”±actorå®šä¹‰é…ç½®å±æ€§. åœ¨éƒ¨ç½²é…ç½®çš„ <tt class="docutils literal"><span class="pre">router</span></tt> å±æ€§ä¸­
æŒ‡å®šä½ çš„è·¯ç”±actorç±»çš„å…¨ç§°ç±»å. è·¯ç”±actorç±»å¿…é¡»æ‰©å±•
<tt class="docutils literal"><span class="pre">akka.routing.RouterConfig</span></tt> å¿…é¡»æœ‰ä»¥ <tt class="docutils literal"><span class="pre">com.typesafe.config.Config</span></tt> ä¸ºå‚æ•°çš„æ„é€ æ–¹æ³•.
é…ç½®æ–‡ä»¶çš„éƒ¨ç½²éƒ¨åˆ†å°†è¢«ä¼ é€’ç»™è¿™ä¸ªæ„é€ æ–¹æ³•.</p>
</div>
<div class="section" id="custom-resizer">
<h3>è‡ªå®šä¹‰æ•°é‡æ”¹å˜å™¨</h3>
<p>è¦å®ä¾‹å¯åŠ¨æ€æ”¹å˜routeeæ•°é‡çš„è·¯ç”±actoréœ€è¦åœ¨<tt class="docutils literal"><span class="pre">RouterConfig</span></tt><tt class="docutils literal"><span class="pre">resizer</span></tt> æ–¹æ³•ä¸­æä¾›ä¸€ä¸ª <tt class="docutils literal"><span class="pre">akka.routing.Resizer</span></tt>
. å‚é˜… <tt class="docutils literal"><span class="pre">akka.routing.DefaultResizer</span></tt> äº†è§£å¦‚ä½•ç¼–å†™è‡ªå·±çš„æ”¹å˜æ•°é‡çš„é€»è¾‘.</p>
</div>
</div>
<div class="section" id="configuring-dispatchers">
<h2>é…ç½®æ´¾å‘å™¨</h2>
<p>ç”¨äºåˆ›å»ºè·¯ç”±actorçš„å­actorçš„æ´¾å‘å™¨å¦‚<a class="reference internal" href="dispatchers.html#dispatchers-scala" tppabs="http://www.gtan.com/akka_doc/scala/dispatchers.html#dispatchers-scala"><em>æ¶ˆæ¯æ´¾å‘å™¨ (Scala)</em></a>ä¸­æ‰€è¿°å–è‡ª
<tt class="xref py py-class docutils literal"><span class="pre">Props</span></tt> . å¯¹äºä¸€ä¸ªåŠ¨æ€çš„æ± ï¼Œå¦‚æœç²¾ç¡®çš„è·¯ç”±å¹¶ä¸é‚£ä¹ˆé‡è¦
 (i.e. å¹¶ä¸ä¸¥æ ¼è¦æ±‚ä¸€è‡´æ€§hashæˆ–round-robin), é…ç½®ä¸€ä¸ª<tt class="xref py py-class docutils literal"><span class="pre">BalancingDispatcher</span></tt>æ˜¯æœ‰æ„ä¹‰çš„;
    è¿™ä½¿å¾—æ–°åˆ›å»ºçš„routeeå¯ä»¥ç«‹å³ä»å…¶å…„å¼Ÿå¤„çªƒå–ä»»åŠ¡æ¥æ‰§è¡Œ.</p>
<p>å½“ç„¶ï¼Œâ€œheadâ€è·¯ç”±actor, ä¸èƒ½è¿è¡Œåœ¨åŒæ ·çš„å¹³è¡¡æ´¾å‘å™¨ä¸Š,
å› ä¸ºå®ƒå¹¶ä¸å¤„ç†ç›¸åŒçš„æ¶ˆæ¯ï¼Œè¿™ä¸ªç‰¹æ®Šçš„actorå¹¶ä¸ä½¿ç”¨ <tt class="xref py py-class docutils literal"><span class="pre">Props</span></tt>ä¸­é…ç½®çš„æ´¾å‘å™¨,
    è€Œæ˜¯ä½¿ç”¨ä» <tt class="xref py py-class docutils literal"><span class="pre">RouterConfig</span></tt> æ¥çš„
<tt class="docutils literal"><span class="pre">routerDispatcher</span></tt> , å®ƒç¼ºçœä¸ºactorç³»ç»Ÿçš„ç¼ºçœæ´¾å‘å™¨.
    æ‰€æœ‰çš„æ ‡å‡†è·¯ç”±actoréƒ½å…è®¸åœ¨å…¶æ„é€ æ–¹æ³•æˆ–å·¥å‚æ–¹æ³•ä¸­è®¾ç½®è¿™ä¸ªå±æ€§ï¼Œè‡ªå®šä¹‰è·¯ç”±å¿…é¡»ä»¥åˆé€‚çš„æ–¹å¼è‡ªå·±å®ç°è¿™ä¸ªæ–¹æ³•.</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">router</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">[</span><span class="kt">MyActor</span><span class="o">]</span>
  <span class="o">.</span><span class="n">withRouter</span><span class="o">(</span><span class="nc">RoundRobinRouter</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">routerDispatcher</span> <span class="k">=</span> <span class="s">&quot;router&quot;</span><span class="o">))</span> <span class="c1">// â€œheadâ€ å°†è¿è¡Œåœ¨ &quot;router&quot; æ´¾å‘å™¨ä¸Š</span>
  <span class="o">.</span><span class="n">withDispatcher</span><span class="o">(</span><span class="s">&quot;workers&quot;</span><span class="o">))</span> <span class="c1">// MyActor workers å°†è¿è¡Œåœ¨ &quot;workers&quot; æ´¾å‘å™¨ä¸Š</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <div class="span3"><p class="contents-title">Contents</p>
              <div id="scroller-anchor">
                <div id="scroller">
                  <div id="toc"></div>
                </div>
              </div></div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
  <div class="container">
    <ul>
      <li><h5>Akka</h5></li>
      <li><a href="javascript:if(confirm('http://akka.io/docs  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://akka.io/docs'" tppabs="http://akka.io/docs">Documentation</a></li>
      <li><a href="javascript:if(confirm('http://akka.io/downloads  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://akka.io/downloads'" tppabs="http://akka.io/downloads">Downloads</a></li>
      <li><a href="javascript:if(confirm('http://akka.io/news  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://akka.io/news'" tppabs="http://akka.io/news">News</a></li>
      <li><a href="javascript:if(confirm('http://letitcrash.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://letitcrash.com/'" tppabs="http://letitcrash.com/">Blog</a></li>
    </ul>
    <ul>
      <li><h5>Contribute</h5></li>
      <li><a href="javascript:if(confirm('http://github.com/akka/akka  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://github.com/akka/akka'" tppabs="http://github.com/akka/akka">Source Code</a></li>
      <li><a href="javascript:if(confirm('http://groups.google.com/group/akka-user  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://groups.google.com/group/akka-user'" tppabs="http://groups.google.com/group/akka-user">Mailing List</a></li>      
      <li><a href="javascript:if(confirm('http://www.assembla.com/spaces/akka/tickets  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.assembla.com/spaces/akka/tickets'" tppabs="http://www.assembla.com/spaces/akka/tickets">Report a Bug</a></li>      
    </ul>
    <ul>
      <li><h5>Company</h5></li>
      <li><a href="javascript:if(confirm('http://typesafe.com/products/typesafe-subscription  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://typesafe.com/products/typesafe-subscription'" tppabs="http://typesafe.com/products/typesafe-subscription">Commercial Support</a></li>
      <li><a href="javascript:if(confirm('http://akka.io/team  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://akka.io/team'" tppabs="http://akka.io/team">Team</a></li>
      <li><a href="mailto:info@typesafe.com">Contact</a></li>
    </ul>
    <ul>
      <li><img src="../_static/watermark.png" tppabs="http://www.gtan.com/akka_doc/_static/watermark.png" align="center"/></li>
    </ul>
  </div>
  <div class="container copyright">
    <p style="float: left;">
      Â© 2012 <a href="javascript:if(confirm('http://typesafe.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://typesafe.com/'" tppabs="http://typesafe.com/">Typesafe Inc.</a> <span class="license">Akka is Open Source and available under the Apache 2 License.</span>
    </p>
    <p style="float: right; font-size: 12px;">
      Last updated: Mar 08, 2012
    </p>          
  </div>
</div>
<script type="text/javascript">
  $('#toc').toc();
</script>
  

  </body>
</html>
<!-- Localized -->